---
title: "Discriminant analysis in R"
output: html_notebook
---


```{r}
library(MASS)
data("iris")
head(iris)

# prior là prior probability mà ta chọn cho  mỗi nhóm. 
# thông thường, ta chọn  prior probability của các nhóm là bằng nhau 
re <- lda(formula = Species ~ ., data = iris, prior = c(1,1,1)/3)
re$counts
re$lev
#  group means.
re$means
# ma trận chuyển các quan sát thành các discriminant functions,  và normalized 
re$scaling
# singular values
re$svd
```

```{r}
# using train-test split
train_index = sample(1:nrow(iris), nrow(iris)*.75)
r3 <- lda(Species ~ ., # training model
         iris, 
         prior = c(1,1,1)/3, 
         subset = train_index)
# predict
test = iris[-train_index, ]
pre = predict(object = r, newdata = test)
# classification result:
pre$class
# percentage of correct prediction
sum(pre$class == test$Species)/nrow(test)
```

